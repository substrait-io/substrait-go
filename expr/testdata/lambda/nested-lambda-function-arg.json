{
  "extensionUrns": [
    {
      "extensionUrnAnchor": 1,
      "urn": "extension:io.substrait:functions_arithmetic"
    }
  ],
  "extensions": [
    {
      "extensionFunction": {
        "extensionUrnReference": 1,
        "functionAnchor": 1,
        "name": "add:i32_i32"
      }
    },
    {
      "extensionFunction": {
        "extensionUrnReference": 1,
        "functionAnchor": 2,
        "name": "apply:i32"
      }
    }
  ],
  "relations": [
    {
      "root": {
        "input": {
          "project": {
            "input": {
              "read": {
                "baseSchema": {
                  "names": ["dummy"],
                  "struct": {
                    "types": [{"i32": {"nullability": "NULLABILITY_REQUIRED"}}],
                    "nullability": "NULLABILITY_REQUIRED"
                  }
                },
                "namedTable": {"names": ["test"]}
              }
            },
            "expressions": [
              {
                "lambda": {
                  "parameters": {
                    "nullability": "NULLABILITY_REQUIRED",
                    "types": [
                      {"i32": {"nullability": "NULLABILITY_REQUIRED"}}
                    ]
                  },
                  "body": {
                    "scalarFunction": {
                      "functionReference": 2,
                      "outputType": {"i32": {"nullability": "NULLABILITY_REQUIRED"}},
                      "arguments": [
                        {
                          "value": {
                            "selection": {
                              "directReference": {"structField": {"field": 0}},
                              "lambdaParameterReference": {"stepsOut": 0}
                            }
                          }
                        },
                        {
                          "value": {
                            "lambda": {
                              "parameters": {
                                "nullability": "NULLABILITY_REQUIRED",
                                "types": [
                                  {"i32": {"nullability": "NULLABILITY_REQUIRED"}}
                                ]
                              },
                              "body": {
                                "scalarFunction": {
                                  "functionReference": 1,
                                  "outputType": {"i32": {"nullability": "NULLABILITY_REQUIRED"}},
                                  "arguments": [
                                    {
                                      "value": {
                                        "selection": {
                                          "directReference": {"structField": {"field": 0}},
                                          "lambdaParameterReference": {"stepsOut": 1}
                                        }
                                      }
                                    },
                                    {
                                      "value": {
                                        "selection": {
                                          "directReference": {"structField": {"field": 0}},
                                          "lambdaParameterReference": {"stepsOut": 0}
                                        }
                                      }
                                    }
                                  ]
                                }
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                }
              }
            ]
          }
        }
      }
    }
  ]
}

